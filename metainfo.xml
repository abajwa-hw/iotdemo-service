<?xml version="1.0"?>
<metainfo>
    <schemaVersion>2.0</schemaVersion>
    <services>
        <service>
            <name>IOTDEMO</name>
            <displayName>IoT Demo</displayName>
            <comment>IoT Demo to show real time monitoring/alerts and predictions of driving violations generated by fleet of trucks. The service currently requires that it is installed on the Ambari server node and that Kafka and Zookeeper and also running on the same node. HBase and Storm must be available on the cluster and started. Falcon must be stopped before installing this service.This service is for &lt;b&gt;Demo purposes only&lt;/b&gt; and is &lt;b&gt;not officially supported&lt;/b&gt;</comment>
            <version>0.0.1-DEMO</version>
            <components>
            	<!--  This service must be installed on same node as Zookeeper and Kafka. HBase and Storm must be available on the cluster and started. Falcon must be stopped before installing this service. -->
                <component>
                  <name>IOTDEMO_MASTER</name>
                  <displayName>IoT Demo</displayName>
                  <category>MASTER</category>
                  <cardinality>1</cardinality>
		          <dependencies>
            		<dependency>
              			<name>KAFKA/KAFKA_BROKER</name>
              			<scope>host</scope>
              			<auto-deploy>
                		<enabled>true</enabled>
                		<co-locate>IOTDEMO/IOTDEMO_MASTER</co-locate>
              			</auto-deploy>
            		</dependency> 		          
            		<dependency>
              			<name>ZOOKEEPER/ZOOKEEPER_SERVER</name>
              			<scope>host</scope>
              			<auto-deploy>
                		<enabled>true</enabled>
                		<co-locate>IOTDEMO/IOTDEMO_MASTER</co-locate>
              			</auto-deploy>
            		</dependency>
            		<dependency>
              			<name>HBASE/HBASE_MASTER</name>
              			<scope>cluster</scope>
              			<auto-deploy>
                		<enabled>true</enabled>
              			</auto-deploy>
            		</dependency>     
            		<dependency>
              			<name>STORM/DRPC_SERVER</name>
              			<scope>cluster</scope>
              			<auto-deploy>
                		<enabled>true</enabled>
              			</auto-deploy>
            		</dependency>               		          		       		
				  </dependencies>                  
                  <commandScript>
                    <script>scripts/master.py</script>
                    <scriptType>PYTHON</scriptType>
                    <timeout>5000</timeout>
                  </commandScript>
                </component>
            </components>

            <osSpecifics>
              <osSpecific>
                <osFamily>redhat6</osFamily>
                <packages>
                   <package><name>git</name></package>  
                   <package><name>wget</name></package>                                  
                   <package><name>zip</name></package>                                  
                   <package><name>tar</name></package>                                  
                   <package><name>java-1.7.0-openjdk-devel</name></package>                                                                                                          
                </packages>
              </osSpecific>
            </osSpecifics> 
            
      		<requiredServices>
        		<service>STORM</service>
               	<service>KAFKA</service>      		
        		<service>ZOOKEEPER</service>
               	<service>HBASE</service>
      		</requiredServices>            
      	    <configuration-dependencies>
        	<config-type>demo-config</config-type>
        	<config-type>user-env</config-type>
      	    </configuration-dependencies>
            <restartRequiredAfterChange>false</restartRequiredAfterChange>
            <quickLinksConfigurations>
              <quickLinksConfiguration>
                <fileName>quicklinks.json</fileName>
                <default>true</default>
              </quickLinksConfiguration>
            </quickLinksConfigurations>            
        </service>
    </services>
</metainfo>
